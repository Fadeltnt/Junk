Imports System.IO
Imports System.ComponentModel
Imports System.Windows.Input

Public Class MyViewModel
    Implements INotifyPropertyChanged

    Private _cheminFichier As String
    Public Property CheminFichier As String
        Get
            Return _cheminFichier
        End Get
        Set(value As String)
            _cheminFichier = value
            OnPropertyChanged("CheminFichier")
            OnPropertyChanged("FichierCharge") ' Met à jour l'activation du bouton
        End Set
    End Property

    ' Propriété pour savoir si un fichier est chargé
    Public ReadOnly Property FichierCharge As Boolean
        Get
            Return Not String.IsNullOrEmpty(CheminFichier) AndAlso File.Exists(CheminFichier)
        End Get
    End Property

    ' Commande pour supprimer le fichier
    Public Property SupprimerFichierCommand As ICommand

    Public Sub New()
        ' Initialisation de la commande avec RelayCommand
        SupprimerFichierCommand = New RelayCommand(AddressOf SupprimerFichier, AddressOf PeutSupprimerFichier)
    End Sub

    ' Vérifie si on peut supprimer le fichier (CanExecute)
    Private Function PeutSupprimerFichier(parameter As Object) As Boolean
        Return FichierCharge
    End Function

    ' Suppression du fichier
    Private Sub SupprimerFichier(parameter As Object)
        Try
            If File.Exists(CheminFichier) Then
                File.Delete(CheminFichier)
                CheminFichier = "" ' Réinitialiser après suppression
                OnPropertyChanged("FichierCharge") ' Met à jour l'état du bouton
            End If
        Catch ex As Exception
            MessageBox.Show("Erreur lors de la suppression du fichier : " & ex.Message)
        End Try
    End Sub

    ' Gestion de la notification de changement de propriété
    Public Event PropertyChanged As PropertyChangedEventHandler Implements INotifyPropertyChanged.PropertyChanged
    Protected Sub OnPropertyChanged(propertyName As String)
        RaiseEvent PropertyChanged(Me, New PropertyChangedEventArgs(propertyName))
    End Sub
End Class
